# Claude SDK API 使用文档

本文档介绍如何使用 DMXAPI 代理服务调用 Anthropic Claude 模型，支持思考模式（Thinking）功能。

## 📍 接口地址

```text
https://www.dmxapi.cn
```

## 🚀 快速开始

### 前置要求

- Python 3.7+
- 安装依赖：`pip install anthropic`

### 获取 API 密钥

请前往 DMXAPI 控制台获取您的专属 API 密钥。

## 💻 示例代码

```python
"""
Anthropic Claude API 测试脚本
使用 DMXAPI 代理服务调用 Claude 模型

功能说明：
- 通过 DMXAPI 网关调用 Claude 模型
- 启用思考模式（Thinking）增强模型推理透明度
- 处理并展示模型响应内容

安装依赖：
pip install anthropic
"""

# =============================================================================
# 导入模块
# =============================================================================
from anthropic import Anthropic


# =============================================================================
# 配置参数
# =============================================================================
# API 配置
API_KEY = "sk-********************************************"  # 替换为你的 DMXAPI 密钥
BASE_URL = "https://www.dmxapi.cn"  # DMXAPI 网关地址

# 模型配置
MODEL_NAME = "claude-sonnet-4-5-20250929"
MAX_TOKENS = 16000
THINKING_BUDGET = 10000

# 提示信息
USER_MESSAGE = "你好"


# =============================================================================
# 初始化客户端
# =============================================================================
print("🚀 正在初始化 Anthropic 客户端...")

# 创建 Anthropic 客户端实例
# 注意：生产环境中建议将 API_KEY 存储在环境变量中
client = Anthropic(
    api_key=API_KEY,
    base_url=BASE_URL
)

print("✅ 客户端初始化完成")


# =============================================================================
# 发送对话请求
# =============================================================================
print(f"\n📤 正在发送消息到模型 {MODEL_NAME}...")

# 发送对话请求并获取响应
response = client.messages.create(
    model=MODEL_NAME,
    max_tokens=MAX_TOKENS,
    thinking={
        "type": "enabled",
        "budget_tokens": THINKING_BUDGET
    },
    messages=[
        {
            "role": "user",
            "content": USER_MESSAGE
        }
    ]
)

print("✅ 消息发送成功，正在处理响应...")


# =============================================================================
# 处理响应内容
# =============================================================================
print("\n📥 响应内容处理中...")

# 遍历响应中的内容块
for block in response.content:
    if block.type == "thinking":
        # 思考摘要：展示模型的推理过程
        print("\n🧠 思考摘要：")
        print("-" * 50)
        print(block.thinking)
        print("-" * 50)
        
    elif block.type == "text":
        # 最终回复：模型生成的文本内容
        print("\n💬 模型回复：")
        print("=" * 50)
        print(block.text)
        print("=" * 50)

print("\n🎉 响应处理完成！")


# =============================================================================
# 脚本结束
# =============================================================================
print("\n✨ 脚本执行完毕")
```

## 📊 返回示例

```json
📤 正在发送消息到模型 claude-sonnet-4-5-20250929...
✅ 消息发送成功，正在处理响应...

📥 响应内容处理中...

🧠 思考摘要：
--------------------------------------------------
The user has greeted me in Chinese with "你好" (nǐ hǎo), which means "hello" or "hi". I should respond politely in Chinese.
--------------------------------------------------

💬 模型回复：
==================================================
你好！很高兴见到你。我是Claude，有什么我可以帮助你的吗？
==================================================

🎉 响应处理完成！

✨ 脚本执行完毕
```

## 🔧 配置说明

### 模型参数

- **MODEL_NAME**: 指定使用的 Claude 模型版本
- **MAX_TOKENS**: 最大输出 token 数量
- **THINKING_BUDGET**: 思考模式预算 token 数量

### 安全建议

- 生产环境中请将 API_KEY 存储在环境变量中
- 定期更换 API 密钥以确保安全

## 📝 注意事项

1. 确保网络连接稳定
2. 检查 API 密钥的有效性
3. 合理设置 token 预算避免超额使用
4. 思考模式会增加响应时间，请根据需求启用

---

<p align="center">
  <small>© 2025 DMXAPI Claude SDK</small>
</p>