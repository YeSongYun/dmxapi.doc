# Gemini API è§†é¢‘åˆ†ææ¥å£æ–‡æ¡£

## ğŸ“Œ æ¥å£åœ°å€

```
https://www.dmxapi.cn/v1beta/models/{model}:generateContent
```



## ğŸ’» Python ç¤ºä¾‹ä»£ç 

```python
"""
========================================
è§†é¢‘åˆ†æè„šæœ¬ - DMXAPI Gemini API è§†é¢‘å†…å®¹åˆ†æå·¥å…·
========================================

åŠŸèƒ½è¯´æ˜:
    ä½¿ç”¨ DMXAPI Gemini API å¯¹è§†é¢‘æ–‡ä»¶è¿›è¡Œæ™ºèƒ½å†…å®¹åˆ†æ
    æ”¯æŒå°†è§†é¢‘æ–‡ä»¶ç¼–ç ä¸º Base64 æ ¼å¼å¹¶å‘é€ç»™ AI æ¨¡å‹è¿›è¡Œåˆ†æ
    
ä½œè€…: DMXAPIå›¢é˜Ÿ
"""

import base64
import json
import requests


# ========================================
# é…ç½®å‚æ•°
# ========================================

model = "gemini-2.5-flash"          # AI æ¨¡å‹åç§°ï¼Œæ”¯æŒè§†é¢‘åˆ†æ
API_URL = f"https://www.dmxapi.cn/v1beta/models/{model}:generateContent"
API_KEY = "sk-*****************************************"  # è¯·æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„ DMXAPI å¯†é’¥
VIDEO_PATH = "test/example.mp4"      # è§†é¢‘æ–‡ä»¶è·¯å¾„


# ========================================
# è§†é¢‘ç¼–ç å‡½æ•°
# ========================================

def encode_video_to_base64(video_path):
    """
    å°†è§†é¢‘æ–‡ä»¶ç¼–ç ä¸º Base64 å­—ç¬¦ä¸²
    
    å‚æ•°:
        video_path (str): è§†é¢‘æ–‡ä»¶çš„è·¯å¾„
        
    è¿”å›:
        str: Base64 ç¼–ç çš„è§†é¢‘æ•°æ®å­—ç¬¦ä¸²ï¼Œå¤±è´¥è¿”å› None
        
    è¯´æ˜:
        Base64 ç¼–ç æ˜¯å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸º ASCII å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼ï¼Œ
        è¿™æ ·å¯ä»¥é€šè¿‡ HTTP è¯·æ±‚å®‰å…¨åœ°ä¼ è¾“è§†é¢‘æ•°æ®ã€‚
    """
    try:
        # ä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€è§†é¢‘æ–‡ä»¶
        with open(video_path, "rb") as video_file:
            # è¯»å–æ–‡ä»¶å†…å®¹
            video_bytes = video_file.read()
            # å°†å­—èŠ‚æ•°æ®ç¼–ç ä¸º Base64 å­—ç¬¦ä¸²
            base64_string = base64.b64encode(video_bytes).decode("utf-8")
            return base64_string
            
    except Exception as e:
        # æ•è·æ‰€æœ‰å¯èƒ½çš„å¼‚å¸¸ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™é—®é¢˜ç­‰ï¼‰
        print(f"âŒ è§†é¢‘ç¼–ç é”™è¯¯: {e}")
        return None


# ========================================
# è§†é¢‘åˆ†æä¸»å‡½æ•°
# ========================================

def analyze_video():
    """
    å‘é€è§†é¢‘åˆ†æè¯·æ±‚åˆ° Gemini API
    
    æ‰§è¡Œæµç¨‹:
        1. æ£€æŸ¥ API å¯†é’¥æ˜¯å¦å­˜åœ¨
        2. å°†è§†é¢‘æ–‡ä»¶ç¼–ç ä¸º Base64 æ ¼å¼
        3. æ„å»º API è¯·æ±‚æ•°æ®
        4. å‘é€ POST è¯·æ±‚åˆ° Gemini API
        5. è§£æå¹¶æ˜¾ç¤ºåˆ†æç»“æœ
    """
    
    # ----------------------------------------
    # æ­¥éª¤ 1: æ£€æŸ¥ DMXAPI å¯†é’¥
    # ----------------------------------------
    if not API_KEY:
        print("âŒ é”™è¯¯: è¯·è®¾ç½® API å¯†é’¥")
        return

    # ----------------------------------------
    # æ­¥éª¤ 2: ç¼–ç è§†é¢‘æ–‡ä»¶
    # ----------------------------------------
    print("ğŸ“¹ æ­£åœ¨ç¼–ç è§†é¢‘æ–‡ä»¶...")
    video_data = encode_video_to_base64(VIDEO_PATH)
    if not video_data:
        print("âŒ è§†é¢‘ç¼–ç å¤±è´¥ï¼Œç¨‹åºç»ˆæ­¢")
        return

    # ----------------------------------------
    # æ­¥éª¤ 3: æ„å»º HTTP è¯·æ±‚
    # ----------------------------------------
    # è®¾ç½®è¯·æ±‚å¤´
    headers = {"Content-Type": "application/json"}
    
    # æ„å»ºè¯·æ±‚è´Ÿè½½ (æŒ‰ç…§ DMXAPI Gemini API æ ¼å¼è¦æ±‚)
    payload = {
        "contents": [{
            "role": "user",                    # è§’è‰²: ç”¨æˆ·
            "parts": [
                {
                    "inlineData": {
                        "mimeType": "video/mp4",    # æ–‡ä»¶ç±»å‹
                        "data": video_data          # Base64 ç¼–ç çš„è§†é¢‘æ•°æ®
                    }
                },
                {
                    "text": "è§†é¢‘æ–‡ä»¶é‡Œéƒ½æ˜¾ç¤ºäº†å“ªäº›å†…å®¹ï¼Ÿ"  # åˆ†ææç¤ºè¯
                }
            ]
        }]
    }

    # ----------------------------------------
    # æ­¥éª¤ 4: å‘é€ API è¯·æ±‚
    # ----------------------------------------
    try:
        print("ğŸš€ æ­£åœ¨å‘é€è¯·æ±‚åˆ° Gemini API...")
        
        # å‘é€ POST è¯·æ±‚
        response = requests.post(
            API_URL,
            headers=headers,
            params={"key": API_KEY},
            json=payload
        )
        
        # æ£€æŸ¥ HTTP çŠ¶æ€ç 
        response.raise_for_status()
        
        # ----------------------------------------
        # æ­¥éª¤ 5: è§£æå“åº”ç»“æœ
        # ----------------------------------------
        result = response.json()
        
        # æå–å¹¶æ˜¾ç¤ºåˆ†æç»“æœ
        if "candidates" in result and len(result["candidates"]) > 0:
            candidate = result["candidates"][0]
            
            if "content" in candidate and "parts" in candidate["content"]:
                # æå– AI ç”Ÿæˆçš„æ–‡æœ¬å†…å®¹
                text_content = candidate["content"]["parts"][0].get("text", "")
                
                # æ˜¾ç¤ºåˆ†æç»“æœ
                print("\n" + "=" * 50)
                print("ğŸ“Š è§†é¢‘åˆ†æç»“æœ")
                print("=" * 50)
                print(text_content)
                
                # æ˜¾ç¤º API ä½¿ç”¨ç»Ÿè®¡
                print("\n" + "=" * 50)
                print("ğŸ“ˆ ä½¿ç”¨ç»Ÿè®¡")
                print("=" * 50)
                if "usageMetadata" in result:
                    usage = result["usageMetadata"]
                    print(f"æ€» Token æ•°:  {usage.get('totalTokenCount', 0)}")
                    print(f"æç¤º Token æ•°: {usage.get('promptTokenCount', 0)}")
                    print(f"å›å¤ Token æ•°: {usage.get('candidatesTokenCount', 0)}")
            else:
                print("âš ï¸  å“åº”æ ¼å¼å¼‚å¸¸ï¼Œæ— æ³•æå–æ–‡æœ¬å†…å®¹")
        else:
            print("âš ï¸  æœªè·å¾—æœ‰æ•ˆçš„åˆ†æç»“æœ")
            
        # è°ƒè¯•é€‰é¡¹: æ˜¾ç¤ºå®Œæ•´çš„ API å“åº”ï¼ˆå¯é€‰ï¼‰
        # print("\n" + "=" * 50)
        # print("ğŸ” å®Œæ•´å“åº”")
        # print("=" * 50)
        # print(json.dumps(result, indent=2, ensure_ascii=False))
        
    except requests.exceptions.RequestException as e:
        # æ•è·æ‰€æœ‰ requests ç›¸å…³çš„å¼‚å¸¸
        print(f"\nâŒ è¯·æ±‚å¤±è´¥: {e}")
        
        # æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
        if hasattr(e, 'response') and e.response:
            print(f"çŠ¶æ€ç : {e.response.status_code}")
            print(f"å“åº”: {e.response.text}")



# ========================================
# ç¨‹åºå…¥å£
# ========================================

if __name__ == "__main__":
    """
    ä¸»ç¨‹åºå…¥å£
    å½“è„šæœ¬ç›´æ¥è¿è¡Œæ—¶æ‰§è¡Œè§†é¢‘åˆ†æ
    (é˜²æ­¢æ¨¡å—è¢«å¯¼å…¥æ—¶è‡ªåŠ¨æ‰§è¡Œ)
    """
    print("=" * 50)
    print("ğŸ¬ Gemini è§†é¢‘åˆ†æå·¥å…·å¯åŠ¨")
    print("=" * 50 )
    
    analyze_video()
    
    print("=" * 50)
    print("âœ… åˆ†æå®Œæˆ")
    print("=" * 50  )
```

## âœ… è¿”å›ç¤ºä¾‹

```json
==================================================
ğŸ¬ Gemini è§†é¢‘åˆ†æå·¥å…·å¯åŠ¨
==================================================
ğŸ“¹ æ­£åœ¨ç¼–ç è§†é¢‘æ–‡ä»¶...
ğŸš€ æ­£åœ¨å‘é€è¯·æ±‚åˆ° Gemini API...

==================================================
ğŸ“Š è§†é¢‘åˆ†æç»“æœ
==================================================
è¿™æ®µè§†é¢‘çš„å¼€å¤´æ˜¾ç¤ºäº†ä¸€åªç™½è‰²çš„é¸Ÿåœ¨é»‘æš—çš„èƒŒæ™¯ä¸­é£ç¿”ã€‚å®ƒå¾ˆå¿«å˜æˆäº†è“è‰²èƒŒæ™¯ä¸­çš„ä¸€åªé¸Ÿï¼Œä¿¯å†²åˆ°è“è‰²èƒŒæ™¯ä¸­çš„æ°´é¢ä¸Šã€‚è¿™åªé¸Ÿæ½œå…¥æ°´ä¸­ï¼Œéœ²å‡ºäº†æ°´ä¸‹æ­£åœ¨è¿å¾™çš„ä¸€å¤§ç¾¤é±¼ã€‚éšåï¼Œä¸€ç¾¤ç™½è‰²çš„é¸Ÿæ½œå…¥æ°´ä¸­ï¼Œéœ²å‡ºäº†å¦ä¸€å¤§ç¾¤é±¼ã€‚åœ¨è¿™ä¹‹åï¼Œä¸€ç¾¤æµ·è±šåœ¨æ•é£Ÿ é‚£äº›é±¼ã€‚è¿™åˆå¼•å‘äº†ä¸€ç¾¤é²¨é±¼åƒé±¼ã€‚æœ€åï¼Œåœ¨è§†é¢‘çš„ç»“å°¾ï¼Œä¸€æ¡é²¸é±¼ä»æ°´é‡Œè·³å‡ºæ¥ã€‚

==================================================
ğŸ“ˆ ä½¿ç”¨ç»Ÿè®¡
==================================================
æ€» Token æ•°:  13391
æç¤º Token æ•°: 13285
å›å¤ Token æ•°: 106
==================================================
âœ… åˆ†æå®Œæˆ
==================================================
```

---

<p align="center">
  <small>Â© 2025 DMXAPI Gemini è§†é¢‘</small>
</p>