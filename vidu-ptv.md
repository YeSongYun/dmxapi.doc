# Viduè§†é¢‘æ¨¡å‹ viduq2-ctvï¼ˆviduq2ï¼‰ å‚è€ƒç”Ÿè§†é¢‘ APIä½¿ç”¨æ–‡æ¡£

ä½œä¸ºå›½å†…é¦–æ¬¾å®ç°å•†ä¸šè½åœ°çš„è§†é¢‘æ¨¡å‹ï¼Œviduq2ä¸€ç»æ¨å‡ºï¼Œå³è·ä¼—å¤šæ·˜å®å•†å®¶é’çã€‚å…¶å“è¶Šçš„è§†é¢‘ç”Ÿæˆèƒ½åŠ›ï¼Œåœ¨çœŸå®æ„Ÿä¸æµç•…åº¦ä¸Šå‡è¡¨ç°å‡ºè‰²ï¼Œæˆä¸ºå¯é çš„å•†ç”¨è§†é¢‘è§£å†³æ–¹æ¡ˆã€‚

## æ¨¡å‹åç§°
`viduq2-ctv`

## æ¥å£åœ°å€
è°ƒç”¨ `viduq2-ctv` å®˜æ–¹æ¥å£éœ€åˆ†ä¸¤æ­¥ï¼š  

1. æäº¤è§†é¢‘ç”Ÿæˆä»»åŠ¡  
2. æ ¹æ®è¿”å›çš„ `ID` æŸ¥è¯¢ç»“æœ  

| åŠŸèƒ½ | ç«¯ç‚¹ |
|------|------|
| æäº¤è§†é¢‘ä»»åŠ¡ | `https://www.dmxapi.cn/v1/responses` |
| æŸ¥è¯¢è§†é¢‘ç»“æœ | `https://www.dmxapi.cn/v1/responses` |


## å¯é€‰å‚æ•°
- `resolution`ï¼šè§†é¢‘åˆ†è¾¨ç‡ï¼Œé»˜è®¤ `720p`ï¼Œå¯é€‰å€¼ï¼š`540p` / `720p` / `1080p`
- `duration`ï¼šè§†é¢‘æ—¶é•¿ï¼ˆå•ä½ï¼šç§’ï¼‰
  - é»˜è®¤å€¼ï¼š`5`
  - å¯é€‰å€¼ï¼š`1` - `10`

## åˆ›å»ºå¤šå›¾å‚è€ƒç”Ÿè§†é¢‘ä»»åŠ¡ç¤ºä¾‹
```python
import requests

import json


# ============================================================================

# é…ç½®éƒ¨åˆ† - API è¿æ¥ä¿¡æ¯

# ============================================================================


# DMXAPI çš„ URL åœ°å€

url = "https://www.dmxapi.cn/v1/responses"


# API å¯†é’¥ - ç”¨äºèº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶
# âš ï¸ è¯·æ›¿æ¢ä¸ºæ‚¨è‡ªå·±å®é™…çš„APIå¯†é’¥
api_key = "sk-******************************"  


# ============================================================================

# è¯·æ±‚å¤´é…ç½® - è®¾ç½®å†…å®¹ç±»å‹å’Œæˆæƒä¿¡æ¯

# ============================================================================

headers = {

    "Content-Type": "application/json",      # æŒ‡å®šè¯·æ±‚ä½“ä¸º JSON æ ¼å¼

    "Authorization": f"{api_key}",    # token è®¤è¯æ–¹å¼

}


# ============================================================================

# è¯·æ±‚å‚æ•°é…ç½® - AI æ¨¡å‹ä¸è¾“å…¥å†…å®¹

# ============================================================================

data = {

    # ---------- åŸºç¡€é…ç½® ----------

    

    "model": "viduq2-ctv",

    "subjects": [

        {

            "id": "1",

            "images": ["https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-2.png", "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-3.png"],

            "voice_id": ""

        },

        {

            "id": "2",

            "images": ["https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-1.png"],

            "voice_id": ""

        },

    ],

    # ---------- prompt æ–‡æœ¬æç¤ºè¯ ----------
    # ç”Ÿæˆè§†é¢‘çš„æ–‡æœ¬æè¿°
    # æ³¨ï¼šå­—ç¬¦é•¿åº¦ä¸èƒ½è¶…è¿‡ 2000 ä¸ªå­—ç¬¦
    "input": "@1 ä¸­çš„ä¸¤ä¸ªå°äººåœ¨ @2 çš„åœºæ™¯ä¸­æ‹¥æŠ±",

    # ---------- è§†é¢‘æ—¶é•¿é…ç½® ----------
    # é»˜è®¤å€¼ï¼š5 ç§’ï¼Œå¯é€‰èŒƒå›´ï¼š1-10 ç§’
    "duration": 8,

    "audio": True,

    # ---------- éšæœºç§å­é…ç½® ----------
    # å½“é»˜è®¤ä¸ä¼ æˆ–è€…ä¼  0 æ—¶ï¼Œä¼šä½¿ç”¨éšæœºæ•°æ›¿ä»£
    # æ‰‹åŠ¨è®¾ç½®åˆ™ä½¿ç”¨è®¾ç½®çš„ç§å­
    "seed": 0,

    "aspect_ratio": "16:9",

    # ---------- è§†é¢‘åˆ†è¾¨ç‡é…ç½® ----------
    # é»˜è®¤å€¼ï¼š720pï¼Œå¯é€‰å€¼ï¼š540pã€720pã€1080p
    "resolution": "720p",

    "movement_amplitude": "auto",

    # ---------- æ°´å°é…ç½® ----------
    # æ˜¯å¦æ·»åŠ æ°´å°
    # - trueï¼šæ·»åŠ æ°´å°
    # - falseï¼šä¸æ·»åŠ æ°´å°
    # æ³¨ï¼šç›®å‰æ°´å°å†…å®¹ä¸ºå›ºå®šï¼Œå†…å®¹ç”± AI ç”Ÿæˆï¼Œé»˜è®¤ä¸åŠ 
    "watermark": False,

    # ---------- æ°´å°ä½ç½®é…ç½® ----------
    # è¡¨ç¤ºæ°´å°å‡ºç°åœ¨å›¾ç‰‡çš„ä½ç½®ï¼Œå¯é€‰é¡¹ä¸ºï¼š
    # 1ï¼šå·¦ä¸Šè§’
    # 2ï¼šå³ä¸Šè§’
    # 3ï¼šå³ä¸‹è§’
    # 4ï¼šå·¦ä¸‹è§’
    "wm_position": 3,

    # ---------- æ°´å°å†…å®¹é…ç½® ----------
    # æ°´å°å†…å®¹ï¼Œæ­¤å¤„ä¸ºå›¾ç‰‡ URL
    # ä¸ä¼ æ—¶ï¼Œä½¿ç”¨é»˜è®¤æ°´å°ï¼šå†…å®¹ç”± AI ç”Ÿæˆ
    "wm_url": "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-3.png",

    # ---------- å›è°ƒåœ°å€é…ç½® ----------
    # Callback åè®®ï¼šè¯·æ±‚æ–¹æ³•ä¸º POST
    # å½“è§†é¢‘ç”Ÿæˆä»»åŠ¡æœ‰çŠ¶æ€å˜åŒ–æ—¶ï¼ŒVidu å°†å‘æ­¤åœ°å€å‘é€åŒ…å«ä»»åŠ¡æœ€æ–°çŠ¶æ€çš„å›è°ƒè¯·æ±‚
    # å›è°ƒè¯·æ±‚å†…å®¹ç»“æ„ä¸æŸ¥è¯¢ä»»åŠ¡ API çš„è¿”å›ä½“ä¸€è‡´
    # å›è°ƒè¿”å›çš„ status åŒ…æ‹¬ä»¥ä¸‹çŠ¶æ€ï¼š
    # - processingï¼šä»»åŠ¡å¤„ç†ä¸­
    # - successï¼šä»»åŠ¡å®Œæˆï¼ˆå¦‚å‘é€å¤±è´¥ï¼Œå›è°ƒä¸‰æ¬¡ï¼‰
    # - failedï¼šä»»åŠ¡å¤±è´¥ï¼ˆå¦‚å‘é€å¤±è´¥ï¼Œå›è°ƒä¸‰æ¬¡ï¼‰
    "callback_url": "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn"




}

# ============================================================================

# å‘é€è¯·æ±‚å¹¶å¤„ç†éæµå¼å“åº”

# ============================================================================


# å‘é€ POST è¯·æ±‚åˆ° API æœåŠ¡å™¨

response = requests.post(url, headers=headers, json=data)


# ----------------------------------------------------------------------------

# å¤„ç†éæµå¼å“åº” - æ ¼å¼åŒ–æ‰“å°åŸå§‹ JSON æ•°æ®

# ----------------------------------------------------------------------------

try:

    # è·å–å“åº”çš„ JSON æ•°æ®

    response_data = response.json()


    # æ ¼å¼åŒ–æ‰“å°åŸå§‹ JSON å“åº”

    # indent=2: ä½¿ç”¨2ä¸ªç©ºæ ¼ç¼©è¿›

    # ensure_ascii=False: ä¿ç•™ä¸­æ–‡å­—ç¬¦ä¸è½¬ä¹‰

    print(json.dumps(response_data, indent=2, ensure_ascii=False))


# ----------------------------------------------------------------------------

# å¼‚å¸¸å¤„ç†

# ----------------------------------------------------------------------------

except KeyboardInterrupt:

    # å¤„ç†ç”¨æˆ·ä¸­æ–­ - å½“ç”¨æˆ·æŒ‰ Ctrl+C æ—¶ä¼˜é›…é€€å‡º

    print("\n\nâš ï¸ ç”¨æˆ·ä¸­æ–­äº†è¯·æ±‚")


except json.JSONDecodeError as e:

    # å¤„ç† JSON è§£æé”™è¯¯

    print(f"âŒ JSON è§£æé”™è¯¯: {e}")

    print(f"åŸå§‹å“åº”å†…å®¹: {response.text}")


except Exception as e:

    # å¤„ç†å…¶ä»–å¼‚å¸¸ - æ•è·å¹¶æ˜¾ç¤ºä»»ä½•æ„å¤–é”™è¯¯

    print(f"âŒ å‘ç”Ÿé”™è¯¯: {e}")

```

### è¿”å›ç¤ºä¾‹

```json
{
  "task_id": "903875784081420288",
  "type": "character2video",
  "state": "created",
  "model": "viduq2",
  "style": "general",
  "prompt": "@2 ä¸­çš„ä¸¤ä¸ªå°äººåœ¨ @1 çš„åœºæ™¯ä¸­æ‹¥æŠ±",
  "images": [
    "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-2.png",
    "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-3.png",
    "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-1.png"
  ],
  "duration": 8,
  "seed": 1070246527,
  "aspect_ratio": "16:9",
  "resolution": "720p",
  "movement_amplitude": "auto",
  "created_at": 1767172295,
  "credits": 75,
  "payload": "",
  "cus_priority": 0,
  "off_peak": false,
  "watermark": false,
  "is_rec": false,
  "wm_position": "bottom_right",
  "wm_url": "https://prod-ss-images.s3.cn-northwest-1.amazonaws.com.cn/vidu-maas/template/reference2video-3.png",
  "meta_data": "",
  "client_request_id": "",
  "usage": {
    "total_tokens": 234375,
    "input_tokens": 0,
    "input_tokens_details": {
      "cached_tokens": 0
    },
    "output_tokens": 234375,
    "output_tokens_details": {
      "reasoning_tokens": 0
    }
  }
}

```

## ä»»åŠ¡ç»“æœæŸ¥è¯¢ç¤ºä¾‹

```python
"""

================================================================================

DMXAPI è§†é¢‘ç”Ÿæˆä»»åŠ¡æŸ¥è¯¢è„šæœ¬

================================================================================


åŠŸèƒ½è¯´æ˜:

    æœ¬è„šæœ¬ç”¨äºæŸ¥è¯¢ DMXAPI å¹³å°ä¸Šè§†é¢‘ç”Ÿæˆä»»åŠ¡çš„çŠ¶æ€å’Œç»“æœã€‚

    é€šè¿‡æä¾›ä»»åŠ¡ IDï¼Œå¯ä»¥å®æ—¶è·å–è§†é¢‘ç”Ÿæˆè¿›åº¦ï¼Œå¹¶åœ¨å®Œæˆåè·å–ä¸‹è½½é“¾æ¥ã€‚

ä¾èµ–åº“:

    - requests: HTTP è¯·æ±‚åº“ï¼Œç”¨äºå‘é€ API è¯·æ±‚

    - json: JSON è§£æåº“ï¼Œç”¨äºå¤„ç†å“åº”æ•°æ®


================================================================================

"""


import requests  # HTTP è¯·æ±‚åº“ - ç”¨äºå‘é€ç½‘ç»œè¯·æ±‚

import json      # JSON å¤„ç†åº“ - ç”¨äºè§£æ API å“åº”æ•°æ®


# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—

# â•‘                           ç¬¬ä¸€éƒ¨åˆ†: API è¿æ¥é…ç½®                              â•‘

# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#

# è¯´æ˜: æ­¤éƒ¨åˆ†é…ç½® API æœåŠ¡å™¨åœ°å€å’Œèº«ä»½éªŒè¯ä¿¡æ¯

#       è¯·ç¡®ä¿ API å¯†é’¥çš„å®‰å…¨æ€§ï¼Œä¸è¦æ³„éœ²ç»™ä»–äºº

#


# API æœåŠ¡ç«¯ç‚¹åœ°å€

# - ç”Ÿäº§ç¯å¢ƒ: https://www.dmxapi.cn/v1/responses

# - è¯¥æ¥å£ç”¨äºæŸ¥è¯¢è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„çŠ¶æ€å’Œç»“æœ

url = "https://www.dmxapi.cn/v1/responses"


# API å¯†é’¥ - ç”¨äºèº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶
# âš ï¸ è¯·æ›¿æ¢ä¸ºæ‚¨è‡ªå·±å®é™…çš„APIå¯†é’¥
api_key = "sk-******************************"


# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—

# â•‘                          ç¬¬äºŒéƒ¨åˆ†: HTTP è¯·æ±‚å¤´é…ç½®                            â•‘

# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#

# è¯´æ˜: HTTP è¯·æ±‚å¤´ç”¨äºå‘ŠçŸ¥æœåŠ¡å™¨è¯·æ±‚çš„æ ¼å¼å’Œè®¤è¯ä¿¡æ¯

#       è¿™æ˜¯ RESTful API è°ƒç”¨çš„æ ‡å‡†é…ç½®

#


headers = {

    # Content-Type: æŒ‡å®šè¯·æ±‚ä½“çš„åª’ä½“ç±»å‹

    # - application/json è¡¨ç¤ºè¯·æ±‚ä½“ä¸º JSON æ ¼å¼

    # - æœåŠ¡å™¨ä¼šæ ¹æ®æ­¤å­—æ®µæ­£ç¡®è§£æè¯·æ±‚æ•°æ®

    "Content-Type": "application/json",


    # Authorization: èº«ä»½éªŒè¯å¤´

    # - è®¤è¯æ–¹æ¡ˆ: OAuth 2.0 æ ‡å‡†çš„ä»¤ç‰Œè®¤è¯æ–¹å¼

    # - æ ¼å¼: "<token>"

    # - æœåŠ¡å™¨é€šè¿‡æ­¤å­—æ®µéªŒè¯è¯·æ±‚è€…èº«ä»½

    "Authorization": f"{api_key}",

}


# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—

# â•‘                          ç¬¬ä¸‰éƒ¨åˆ†: è¯·æ±‚å‚æ•°é…ç½®                               â•‘

# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#

# è¯´æ˜: æ­¤éƒ¨åˆ†å®šä¹‰å‘é€ç»™ API çš„æ ¸å¿ƒå‚æ•°

#       åŒ…æ‹¬æ¨¡å‹é€‰æ‹©ã€ä»»åŠ¡ ID å’Œå“åº”æ¨¡å¼

#


data = {

    # model: æŒ‡å®šæŸ¥è¯¢æ‰€ä½¿ç”¨çš„æ¨¡å‹/æ¥å£

    # - viduq2-pro-get: Vidu Q2 Pro ç‰ˆæœ¬çš„ä»»åŠ¡æŸ¥è¯¢æ¥å£ï¼ˆè¿™ä¸ªæ¨¡å‹ä¸è¦æ›´æ”¹ï¼Œå°±ç”¨viduq2-pro-getï¼‰

    # - ä¸åŒæ¨¡å‹å¯¹åº”ä¸åŒçš„è§†é¢‘ç”Ÿæˆèƒ½åŠ›

    "model": "vidu-get",


    # input: è¦æŸ¥è¯¢çš„ä»»åŠ¡ ID
    # âš ï¸è¯·æ›¿æ¢ä¸ºæ‚¨åœ¨"åˆ›å»ºå¤šå›¾å‚è€ƒç”Ÿè§†é¢‘ä»»åŠ¡ç¤ºä¾‹"çš„è¿”å›ç»“æœä¸­è·å–çš„å®é™…çš„ä»»åŠ¡ID
    "input": "**************************",


    # stream: æ˜¯å¦å¯ç”¨æµå¼å“åº”

    # - True: å¯ç”¨ SSE æµå¼ä¼ è¾“ï¼Œå®æ—¶æ¥æ”¶ç”Ÿæˆè¿›åº¦

    # - False: ç­‰å¾…ä»»åŠ¡å®Œæˆåä¸€æ¬¡æ€§è¿”å›ç»“æœ

    # - æ¨èä½¿ç”¨ True ä»¥è·å¾—æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

    "stream": True

}


# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—

# â•‘                       ç¬¬å››éƒ¨åˆ†: å‘é€è¯·æ±‚å¹¶å¤„ç†å“åº”                             â•‘

# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#

# è¯´æ˜: æ­¤éƒ¨åˆ†è´Ÿè´£å‘é€ HTTP è¯·æ±‚å¹¶å¤„ç†æœåŠ¡å™¨è¿”å›çš„æµå¼å“åº”

#       ä½¿ç”¨ SSE æŠ€æœ¯å®æ—¶æ¥æ”¶ä»»åŠ¡è¿›åº¦æ›´æ–°

#


# ----------------------------- 4.1 è¾“å‡ºå¯åŠ¨ä¿¡æ¯ -----------------------------

# å‘ç”¨æˆ·æ˜¾ç¤ºç¨‹åºå·²å¼€å§‹æ‰§è¡Œï¼Œæä¾›æ¸…æ™°çš„è§†è§‰åˆ†éš”

print("=" * 60)

print("ğŸš€ å‘é€æµå¼è¯·æ±‚...")

print("=" * 60)


# ----------------------------- 4.2 å‘é€ API è¯·æ±‚ -----------------------------

# requests.post() å‚æ•°è¯´æ˜:

# - url: API æœåŠ¡ç«¯ç‚¹åœ°å€

# - headers: HTTP è¯·æ±‚å¤´ï¼ŒåŒ…å«è®¤è¯ä¿¡æ¯

# - json: è¯·æ±‚ä½“æ•°æ®ï¼Œä¼šè‡ªåŠ¨åºåˆ—åŒ–ä¸º JSON

# - stream=True: å¯ç”¨æµå¼å“åº”ï¼Œå…è®¸é€è¡Œè¯»å–è¿”å›æ•°æ®

response = requests.post(url, headers=headers, json=data, stream=True)


# è¾“å‡º HTTP çŠ¶æ€ç ï¼Œä¾¿äºè°ƒè¯•å’Œç¡®è®¤è¯·æ±‚æ˜¯å¦æˆåŠŸ

# - 200: è¯·æ±‚æˆåŠŸ

# - 401: è®¤è¯å¤±è´¥ï¼ˆæ£€æŸ¥ API å¯†é’¥ï¼‰

# - 404: ä»»åŠ¡ä¸å­˜åœ¨ï¼ˆæ£€æŸ¥ä»»åŠ¡ IDï¼‰

# - 500: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

print(f"çŠ¶æ€ç : {response.status_code}")

print("-" * 60)

print()


# ----------------------------- 4.3 å¤„ç†æµå¼å“åº” -----------------------------

# SSE (Server-Sent Events) å“åº”æ ¼å¼è¯´æ˜:

# - æ¯æ¡æ¶ˆæ¯ä»¥ "data: " å¼€å¤´

# - åè·Ÿ JSON æ ¼å¼çš„æ•°æ®

# - æ¶ˆæ¯ä¹‹é—´ç”¨ç©ºè¡Œåˆ†éš”

#

# å“åº”æ•°æ®ç»“æ„ç¤ºä¾‹:

# {

#     "delta": "å½“å‰è¿›åº¦: 50%",        // å¢é‡æ›´æ–°å†…å®¹

#     "type": "response.completed"    // å“åº”ç±»å‹æ ‡è¯†

# }

#

try:

    # iter_lines(): è¿­ä»£å™¨æ–¹æ³•ï¼Œé€è¡Œè¯»å–å“åº”å†…å®¹

    # - é¿å…ä¸€æ¬¡æ€§åŠ è½½å…¨éƒ¨æ•°æ®åˆ°å†…å­˜

    # - é€‚åˆå¤„ç†å¤§é‡æˆ–æŒç»­çš„æµå¼æ•°æ®

    for line in response.iter_lines():

        # è·³è¿‡ç©ºè¡Œï¼ˆSSE åè®®ä¸­ç”¨äºåˆ†éš”æ¶ˆæ¯ï¼‰

        if line:

            # å°†å­—èŠ‚æ•°æ®è§£ç ä¸º UTF-8 å­—ç¬¦ä¸²

            decoded_line = line.decode('utf-8')


            # --------------- 4.3.1 è§£æ SSE æ•°æ®æ ¼å¼ ---------------

            # æ£€æŸ¥æ˜¯å¦ä¸ºæ ‡å‡† SSE æ•°æ®è¡Œ

            if decoded_line.startswith('data: '):

                # æå– JSON éƒ¨åˆ†ï¼ˆå»æ‰ "data: " å‰ç¼€ï¼Œå…± 6 ä¸ªå­—ç¬¦ï¼‰

                json_str = decoded_line[6:]


                try:

                    # å°† JSON å­—ç¬¦ä¸²è§£æä¸º Python å­—å…¸

                    data_obj = json.loads(json_str)


                    # --------------- 4.3.2 å¤„ç†å¢é‡æ›´æ–° ---------------

                    # delta å­—æ®µåŒ…å«å®æ—¶è¿›åº¦ä¿¡æ¯

                    if 'delta' in data_obj:

                        delta_text = data_obj['delta']


                        # æ£€æµ‹ä»»åŠ¡å®Œæˆä¿¡å·

                        # å½“æ”¶åˆ°å®Œæˆæ¶ˆæ¯æ—¶ï¼Œæ˜¾ç¤º 100% è¿›åº¦æ¡

                        if 'âœ… è§†é¢‘ç”Ÿæˆå®Œæˆ' in delta_text:

                            print('\r[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100.00% ç”Ÿæˆå®Œæˆ!', flush=True)


                        # è¾“å‡ºå¢é‡å†…å®¹

                        # - end='': ä¸æ¢è¡Œï¼Œä¿æŒè¿›åº¦æ¡åœ¨åŒä¸€è¡Œæ›´æ–°

                        # - flush=True: ç«‹å³åˆ·æ–°è¾“å‡ºç¼“å†²åŒº

                        print(delta_text, end='', flush=True)


                    # --------------- 4.3.3 å¤„ç†å®Œæˆä¿¡å· ---------------

                    # type='response.completed' è¡¨ç¤ºå“åº”æµç»“æŸ

                    elif data_obj.get('type') == 'response.completed':

                        # å“åº”å®Œæˆï¼Œæ— éœ€é¢å¤–å¤„ç†

                        # æ­¤æ—¶æ‰€æœ‰æ•°æ®å·²é€šè¿‡ delta è¾“å‡º

                        pass


                except json.JSONDecodeError:

                    # JSON è§£æå¤±è´¥æ—¶ï¼Œç›´æ¥è¾“å‡ºåŸå§‹å†…å®¹

                    # å¯èƒ½æ˜¯æœåŠ¡å™¨è¿”å›äº†éæ ‡å‡†æ ¼å¼çš„æ•°æ®

                    print(decoded_line)


# ----------------------------- 4.4 å¼‚å¸¸å¤„ç† -----------------------------

except KeyboardInterrupt:

    # æ•è· Ctrl+C ä¸­æ–­ä¿¡å·

    # å…è®¸ç”¨æˆ·ä¼˜é›…åœ°ç»ˆæ­¢é•¿æ—¶é—´è¿è¡Œçš„æŸ¥è¯¢

    print("\n\nâš ï¸ ç”¨æˆ·ä¸­æ–­äº†è¯·æ±‚")


except Exception as e:

    # æ•è·æ‰€æœ‰å…¶ä»–å¼‚å¸¸

    # åŒ…æ‹¬ç½‘ç»œé”™è¯¯ã€è¿æ¥è¶…æ—¶ç­‰

    print(f"\n\nâŒ å‘ç”Ÿé”™è¯¯: {e}")


# ----------------------------- 4.5 è¾“å‡ºç»“æŸä¿¡æ¯ -----------------------------

# ç¨‹åºæ‰§è¡Œå®Œæ¯•ï¼Œè¾“å‡ºç»“æŸæ ‡è¯†

print()

print("=" * 60)

print("ğŸ æµå¼è¾“å‡ºç»“æŸ")

print("=" * 60)

```

### è¿”å›ç¤ºä¾‹
```json
============================================================
ğŸš€ å‘é€æµå¼è¯·æ±‚...
============================================================
çŠ¶æ€ç : 200
------------------------------------------------------------

[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100.00% ç”Ÿæˆå®Œæˆ!


âœ… è§†é¢‘ç”Ÿæˆå®Œæˆï¼

ä»»åŠ¡ID: 903875784081420288

--- åˆ›ä½œ 1 ---
è§†é¢‘URL: https://prod-ss-vidu.s3.cn-northwest-1.amazonaws.com.cn/infer/tasks/25/1231/09/903875784081420288/creation-01/video.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARRHG6JR7EMNHVUWT%2F20251231%2Fcn-northwest-1%2Fs3%2Faws4_request&X-Amz-Date=20251231T091307Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&response-cache-control=max-age%3D86400&response-content-disposition=attachment%3Bfilename%3Dgeneral-9-2025-12-31T09%253A13%253A04Z.mp4&x-id=GetObject&X-Amz-Signature=1625f8aa540c0ce09cf043f353b443352365e0d2baa3c6b0b0a7df2427843ac9
å°é¢URL: https://prod-ss-vidu.s3.cn-northwest-1.amazonaws.com.cn/infer/tasks/25/1231/09/903875784081420288/creation-01/cover.jpeg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARRHG6JR7EMNHVUWT%2F20251231%2Fcn-northwest-1%2Fs3%2Faws4_request&X-Amz-Date=20251231T091307Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&response-cache-control=max-age%3D86400&x-id=GetObject&X-Amz-Signature=6746c50de6b7062409950751b3d9dcc43a6f0b33e6933246dfa0d03768782e83

============================================================
ğŸ æµå¼è¾“å‡ºç»“æŸ
============================================================
```

---

<p align="center">
  <small>Â© 2025 DMXAPI viduq2-ctv</small>
</p>