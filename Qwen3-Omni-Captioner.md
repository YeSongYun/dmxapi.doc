# qwen3-omni-30b-a3b-captioner éŸ³é¢‘ç†è§£ API æ–‡æ¡£

Qwen3-Omni-Captioneræ˜¯ä»¥é€šä¹‰åƒé—®3-Omniä¸ºåŸºåº§çš„å¼€æºæ¨¡å‹ï¼Œæ— éœ€ä»»ä½•æç¤ºï¼Œè‡ªåŠ¨ä¸ºå¤æ‚è¯­éŸ³ã€ç¯å¢ƒå£°ã€éŸ³ä¹ã€å½±è§†å£°æ•ˆç­‰ç”Ÿæˆç²¾å‡†ã€å…¨é¢çš„æè¿°ï¼Œèƒ½è¯†åˆ«è¯´è¯äººçš„æƒ…ç»ªã€éŸ³ä¹å…ƒç´ ï¼ˆå¦‚é£æ ¼ã€ä¹å™¨ï¼‰ã€æ•æ„Ÿä¿¡æ¯ç­‰ï¼Œé€‚ç”¨äºéŸ³é¢‘å†…å®¹åˆ†æã€å®‰å…¨å®¡æ ¸ã€æ„å›¾è¯†åˆ«ã€éŸ³é¢‘å‰ªè¾‘ç­‰å¤šä¸ªé¢†åŸŸã€‚

## ğŸ“ è¯·æ±‚åœ°å€

```
https://www.dmxapi.cn/v1/chat/completions
```

## ğŸ¯ æ¨¡å‹åç§°

`qwen3-omni-30b-a3b-captioner` 

## ğŸ’» éŸ³é¢‘ç†è§£URL è°ƒç”¨ç¤ºä¾‹

```python
# ============================================================================
#                    Qwen3-Omni éŸ³é¢‘ç†è§£ç¤ºä¾‹ (URLæ–¹å¼)
# ============================================================================
# åŠŸèƒ½è¯´æ˜ï¼šé€šè¿‡URLæ–¹å¼ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶ï¼Œä½¿ç”¨Qwen3-Omniæ¨¡å‹è¿›è¡ŒéŸ³é¢‘å†…å®¹ç†è§£
# æ¨¡å‹åç§°ï¼šqwen3-omni-30b-a3b-captioner
# ============================================================================

import requests

# ----------------------------------------------------------------------------
#                              API é…ç½®ä¿¡æ¯
# ----------------------------------------------------------------------------
# æ¥å£åœ°å€ï¼šDMXAPI Chat Completions ç«¯ç‚¹
url = "https://www.dmxapi.cn/v1/chat/completions"

# è¯·æ±‚å¤´é…ç½®
headers = {
    "Authorization": "sk-*****************************************",  # APIå¯†é’¥
    "Content-Type": "application/json"                                              # å†…å®¹ç±»å‹
}

# ----------------------------------------------------------------------------
#                              è¯·æ±‚ä½“æ„å»º
# ----------------------------------------------------------------------------
data = {
    # æŒ‡å®šä½¿ç”¨çš„æ¨¡å‹
    "model": "qwen3-omni-30b-a3b-captioner",

    # æ¶ˆæ¯åˆ—è¡¨
    "messages": [
        {
            "role": "user",
            "content": [
                {
                    # éŸ³é¢‘è¾“å…¥ç±»å‹
                    "type": "input_audio",
                    "input_audio": {
                        # éŸ³é¢‘æ–‡ä»¶URLåœ°å€ï¼ˆæ”¯æŒå…¬ç½‘å¯è®¿é—®çš„éŸ³é¢‘é“¾æ¥ï¼‰
                        "data": "https://help-static-aliyun-doc.aliyuncs.com/file-manage-files/zh-CN/20240916/xvappi/è£…ä¿®å™ªéŸ³.wav"
                    }
                }
            ]
        }
    ]
}

# ----------------------------------------------------------------------------
#                              å‘é€è¯·æ±‚å¹¶è¾“å‡ºç»“æœ
# ----------------------------------------------------------------------------
response = requests.post(url, headers=headers, json=data)
print(response.json())
```

## ğŸš— éŸ³é¢‘ç†è§£URLï¼ˆæµå¼è¾“å‡ºï¼‰è°ƒç”¨ç¤ºä¾‹
```python
# ============================================================================
#              Qwen3-Omni éŸ³é¢‘ç†è§£ç¤ºä¾‹ (URLæ–¹å¼ - æµå¼è¾“å‡º)
# ============================================================================
# åŠŸèƒ½è¯´æ˜ï¼šé€šè¿‡URLæ–¹å¼ä¸Šä¼ éŸ³é¢‘ï¼Œä½¿ç”¨æµå¼è¾“å‡ºå®æ—¶è·å–æ¨¡å‹å“åº”
# æ¨¡å‹åç§°ï¼šqwen3-omni-30b-a3b-captioner
# ============================================================================

import requests
import json
import time

# ----------------------------------------------------------------------------
#                              API é…ç½®ä¿¡æ¯
# ----------------------------------------------------------------------------
API_KEY = "sk-******************************************"  # APIå¯†é’¥
BASE_URL = "https://www.dmxapi.cn/v1/chat/completions"            # æ¥å£åœ°å€

# ----------------------------------------------------------------------------
#                              è¯·æ±‚å¤´é…ç½®
# ----------------------------------------------------------------------------
headers = {
    "Authorization": f"{API_KEY}",  # è®¤è¯ä¿¡æ¯
    "Content-Type": "application/json"     # å†…å®¹ç±»å‹
}

# ----------------------------------------------------------------------------
#                              è¯·æ±‚ä½“æ„å»º
# ----------------------------------------------------------------------------
data = {
    # æŒ‡å®šä½¿ç”¨çš„æ¨¡å‹
    "model": "qwen3-omni-30b-a3b-captioner",

    # æ¶ˆæ¯åˆ—è¡¨
    "messages": [
        {
            "role": "user",
            "content": [
                {
                    "type": "input_audio",      # éŸ³é¢‘è¾“å…¥ç±»å‹
                    "input_audio": {
                        # éŸ³é¢‘æ–‡ä»¶URLåœ°å€
                        "data": "https://help-static-aliyun-doc.aliyuncs.com/file-manage-files/zh-CN/20240916/xvappi/%E8%A3%85%E4%BF%AE%E5%99%AA%E9%9F%B3.wav"
                    }
                }
            ]
        }
    ],

    # ------------------------------------------------------------------------
    #                           æµå¼è¾“å‡ºé…ç½®
    # ------------------------------------------------------------------------
    "stream": True,                 # å¯ç”¨æµå¼è¾“å‡º
    "stream_options": {
        "include_usage": True       # åœ¨æµå¼å“åº”ä¸­åŒ…å«Tokenç”¨é‡ç»Ÿè®¡
    }
}


# ============================================================================
#                              ä¸»å‡½æ•°
# ============================================================================
def main():
    """
    ä¸»å‡½æ•°ï¼šå‘é€æµå¼è¯·æ±‚å¹¶å¤„ç†å“åº”
    åŠŸèƒ½åŒ…æ‹¬ï¼šå®æ—¶è¾“å‡ºã€é¦–Tokenå»¶è¿Ÿè®¡ç®—ã€Tokenç”¨é‡ç»Ÿè®¡
    """
    print("å¼€å§‹è¯·æ±‚...")

    # ------------------------------------------------------------------------
    #                           åˆå§‹åŒ–è®¡æ—¶ä¸å˜é‡
    # ------------------------------------------------------------------------
    start_time = time.time()      # è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´
    first_token_time = None       # é¦–ä¸ªTokenåˆ°è¾¾æ—¶é—´
    full_response = ""            # å®Œæ•´å“åº”å†…å®¹
    usage_info = None             # Tokenç”¨é‡ä¿¡æ¯

    # ------------------------------------------------------------------------
    #                           å‘é€æµå¼è¯·æ±‚
    # ------------------------------------------------------------------------
    try:
        response = requests.post(
            BASE_URL,
            headers=headers,
            json=data,
            stream=True               # å¯ç”¨æµå¼æ¥æ”¶
        )
        response.raise_for_status()   # æ£€æŸ¥HTTPçŠ¶æ€ç 

        # --------------------------------------------------------------------
        #                       é€è¡Œå¤„ç†æµå¼å“åº”
        # --------------------------------------------------------------------
        for line in response.iter_lines():
            if line:
                line = line.decode('utf-8')

                # å¤„ç†SSEæ ¼å¼æ•°æ®ï¼ˆä»¥"data: "å¼€å¤´ï¼‰
                if line.startswith("data: "):
                    json_str = line[6:]           # å»æ‰ "data: " å‰ç¼€

                    # æ£€æµ‹æµç»“æŸæ ‡å¿—
                    if json_str == "[DONE]":
                        break

                    try:
                        chunk = json.loads(json_str)

                        # æå–å¹¶è¾“å‡ºå†…å®¹ç‰‡æ®µ
                        if "choices" in chunk and len(chunk["choices"]) > 0:
                            delta = chunk["choices"][0].get("delta", {})
                            content = delta.get("content", "")

                            if content:
                                # è®°å½•é¦–Tokenæ—¶é—´
                                if first_token_time is None:
                                    first_token_time = time.time()
                                # å®æ—¶è¾“å‡ºå†…å®¹ï¼ˆä¸æ¢è¡Œï¼‰
                                print(content, end="", flush=True)
                                full_response += content

                        # æå–Tokenç”¨é‡ä¿¡æ¯
                        if "usage" in chunk:
                            usage_info = chunk["usage"]

                    except json.JSONDecodeError:
                        continue

        print("\n")

    # ------------------------------------------------------------------------
    #                           å¼‚å¸¸å¤„ç†
    # ------------------------------------------------------------------------
    except requests.exceptions.RequestException as e:
        print(f"\nè¯·æ±‚é”™è¯¯: {e}")
        return

    # ========================================================================
    #                           ç»Ÿè®¡ä¿¡æ¯è¾“å‡º
    # ========================================================================
    end_time = time.time()
    total_time = end_time - start_time

    print("=" * 50)
    print("ç»Ÿè®¡ä¿¡æ¯:")
    print(f"  æ€»è€—æ—¶: {total_time:.2f}ç§’")

    # é¦–Tokenå»¶è¿Ÿ (TTFT: Time To First Token)
    if first_token_time:
        ttft = first_token_time - start_time
        print(f"  é¦–Tokenå»¶è¿Ÿ: {ttft:.2f}ç§’")

    # Tokenç”¨é‡è¯¦æƒ…
    if usage_info:
        prompt_tokens = usage_info.get("prompt_tokens", 0)
        completion_tokens = usage_info.get("completion_tokens", 0)
        total_tokens = usage_info.get("total_tokens", 0)

        print(f"  è¾“å…¥Tokens: {prompt_tokens}")
        print(f"  è¾“å‡ºTokens: {completion_tokens}")
        print(f"  æ€»Tokens: {total_tokens}")

        # è®¡ç®—è¾“å‡ºé€Ÿåº¦
        if total_time > 0 and completion_tokens > 0:
            tokens_per_sec = completion_tokens / total_time
            print(f"  è¾“å‡ºé€Ÿåº¦: {tokens_per_sec:.2f} tokens/ç§’")


# ============================================================================
#                              ç¨‹åºå…¥å£
# ============================================================================
if __name__ == "__main__":
    main()
```



## ğŸš€éŸ³é¢‘ç†è§£æœ¬åœ°ï¼ˆbase64ï¼‰

```python
# ============================================================================
#              Qwen3-Omni éŸ³é¢‘ç†è§£ç¤ºä¾‹ (æœ¬åœ°æ–‡ä»¶ - Base64æ–¹å¼)
# ============================================================================
# åŠŸèƒ½è¯´æ˜ï¼šè¯»å–æœ¬åœ°éŸ³é¢‘æ–‡ä»¶ï¼Œè½¬æ¢ä¸ºBase64ç¼–ç åå‘é€ç»™æ¨¡å‹è¿›è¡Œç†è§£
# æ¨¡å‹åç§°ï¼šqwen3-omni-30b-a3b-captioner
# é€‚ç”¨åœºæ™¯ï¼šæœ¬åœ°éŸ³é¢‘æ–‡ä»¶å¤„ç†ã€æ— å…¬ç½‘URLçš„éŸ³é¢‘åˆ†æ
# ============================================================================

import base64
import requests

# ----------------------------------------------------------------------------
#                              API é…ç½®ä¿¡æ¯
# ----------------------------------------------------------------------------
api_key = "sk-************************************************"  # APIå¯†é’¥
url = "https://www.dmxapi.cn/v1/chat/completions"                 # æ¥å£åœ°å€

# ----------------------------------------------------------------------------
#                              éŸ³é¢‘æ–‡ä»¶é…ç½®
# ----------------------------------------------------------------------------
# å¡«å†™æœ¬åœ°éŸ³é¢‘æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒ wavã€mp3 ç­‰æ ¼å¼
# ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤ç¤ºä¾‹æ•°æ®
file_path = "qwen/è£…ä¿®å™ªéŸ³.wav"  # ä¾‹å¦‚: "C:/audio/test.mp3"


# ============================================================================
#                              å·¥å…·å‡½æ•°
# ============================================================================
def file_to_base64(path):
    """
    è¯»å–æœ¬åœ°æ–‡ä»¶å¹¶è½¬æ¢ä¸ºBase64ç¼–ç å­—ç¬¦ä¸²

    å‚æ•°:
        path: æ–‡ä»¶è·¯å¾„
    è¿”å›:
        Base64ç¼–ç çš„å­—ç¬¦ä¸²
    """
    with open(path, "rb") as f:
        return base64.b64encode(f.read()).decode("utf-8")


# ----------------------------------------------------------------------------
#                           éŸ³é¢‘æ•°æ®å‡†å¤‡
# ----------------------------------------------------------------------------
# æ ¹æ®æ˜¯å¦å¡«å†™æ–‡ä»¶è·¯å¾„ï¼Œè‡ªåŠ¨è½¬æ¢æœ¬åœ°æ–‡ä»¶æˆ–ä½¿ç”¨ç¤ºä¾‹æ•°æ®
if file_path:
    audio_data = f"data:;base64,{file_to_base64(file_path)}"
else:
    # é»˜è®¤ç¤ºä¾‹æ•°æ®ï¼ˆBase64ç¼–ç çš„éŸ³é¢‘ç‰‡æ®µï¼‰
    audio_data = "data:;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5...."

# ----------------------------------------------------------------------------
#                              è¯·æ±‚å¤´é…ç½®
# ----------------------------------------------------------------------------
headers = {
    "Authorization": f"{api_key}",  # è®¤è¯ä¿¡æ¯
    "Content-Type": "application/json"     # å†…å®¹ç±»å‹
}

# ----------------------------------------------------------------------------
#                              è¯·æ±‚ä½“æ„å»º
# ----------------------------------------------------------------------------
data = {
    # æŒ‡å®šä½¿ç”¨çš„æ¨¡å‹
    "model": "qwen3-omni-30b-a3b-captioner",

    # æ¶ˆæ¯åˆ—è¡¨
    "messages": [
        {
            "role": "user",
            "content": [
                {
                    "type": "input_audio",      # éŸ³é¢‘è¾“å…¥ç±»å‹
                    "input_audio": {
                        "data": audio_data      # Base64ç¼–ç çš„éŸ³é¢‘æ•°æ®
                    }
                }
            ]
        }
    ]
}

# ----------------------------------------------------------------------------
#                           å‘é€è¯·æ±‚å¹¶è¾“å‡ºç»“æœ
# ----------------------------------------------------------------------------
response = requests.post(url, headers=headers, json=data)
print(response.json())
```

## ğŸ“š é˜¿é‡Œå®˜æ–¹ç½‘ç«™

```
https://help.aliyun.com/zh/model-studio/qwen3-omni-captioner

```

---

<p align="center">

  <small>Â© 2025 DMXAPI qwen3-omni-30b-a3b-captioneréŸ³é¢‘ç†è§£ </small>

</p>