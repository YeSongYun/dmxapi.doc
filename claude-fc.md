# Claude åŸç”Ÿæ ¼å¼ å‡½æ•°è°ƒç”¨ API æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Claude åŸç”Ÿæ ¼å¼è¿›è¡Œå‡½æ•°è°ƒç”¨ API çš„é›†æˆä¸å¼€å‘ã€‚

## ğŸ”— æ¥å£åœ°å€

**è¯·æ±‚ç«¯ç‚¹ï¼š** `https://www.dmxapi.cn/v1/messages`

## ğŸ’» Python ç¤ºä¾‹ä»£ç 

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Python ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Claude å‡½æ•°è°ƒç”¨ APIï¼š

```python
"""
DMX API æµ‹è¯•è„šæœ¬

åŠŸèƒ½è¯´æ˜ï¼š
- æµ‹è¯• DMX API çš„å¯¹è¯åŠŸèƒ½
- æ¼”ç¤ºå·¥å…·è°ƒç”¨ï¼ˆå¤©æ°”æŸ¥è¯¢ï¼‰çš„ä½¿ç”¨
- åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼åŒ–

ä½œè€…ï¼šDMX API å›¢é˜Ÿ
"""

import requests
import os
import json

# =============================================================================
# é…ç½®å‚æ•°åŒºåŸŸ
# =============================================================================

# API å¯†é’¥é…ç½®
# ä¼˜å…ˆä»ç¯å¢ƒå˜é‡ DMXAPI_API_KEY è·å–ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä½¿ç”¨é»˜è®¤å¯†é’¥
api_key = os.getenv('DMXAPI_API_KEY', 'sk-********************************************')

# API ç«¯ç‚¹ URL
url = "https://www.dmxapi.cn/v1/messages"

# =============================================================================
# è¯·æ±‚å¤´é…ç½®
# =============================================================================

headers = {
    "content-type": "application/json",      # æŒ‡å®šè¯·æ±‚å†…å®¹ä¸º JSON æ ¼å¼
    "x-api-key": api_key                     # è®¤è¯å¯†é’¥
}

# =============================================================================
# è¯·æ±‚æ•°æ®æ„é€ 
# =============================================================================

data = {
    # ä½¿ç”¨çš„æ¨¡å‹åç§°
    "model": "claude-sonnet-4-5-20250929",
    
    # å¯¹è¯æ¶ˆæ¯åˆ—è¡¨
    "messages": [
        {
            "role": "user",                   # ç”¨æˆ·è§’è‰²
            "content": "ä»Šå¤©åŒ—äº¬çš„å¤©æ°”æ€ä¹ˆæ ·?"  # ç”¨æˆ·è¾“å…¥å†…å®¹
        }
    ],
    
    # å¯ç”¨çš„å·¥å…·å®šä¹‰
    "tools": [
        {
            "name": "get_weather",           # å·¥å…·åç§°
            "description": "è·å–æŒ‡å®šä½ç½®çš„å½“å‰å¤©æ°”",  # å·¥å…·æè¿°
            "input_schema": {                # è¾“å…¥å‚æ•°å®šä¹‰
                "type": "object",
                "properties": {
                    "location": {
                        "type": "string",
                        "description": "åŸå¸‚åç§°,å¦‚:åŒ—äº¬"  # å‚æ•°è¯´æ˜
                    }
                },
                "required": ["location"]     # å¿…éœ€å‚æ•°
            }
        }
    ]
}

# =============================================================================
# ä¸»ç¨‹åºæ‰§è¡ŒåŒºåŸŸ
# =============================================================================

def main():
    """
    ä¸»å‡½æ•°ï¼šæ‰§è¡Œ API è¯·æ±‚å¹¶å¤„ç†å“åº”
    """
    print("ğŸš€ å¼€å§‹æ‰§è¡Œ DMX API æµ‹è¯•...")
    print("=" * 50)
    
    try:
        # å‘é€ POST è¯·æ±‚åˆ° API ç«¯ç‚¹
        print("ğŸ“¡ æ­£åœ¨å‘é€è¯·æ±‚åˆ° DMX API...")
        response = requests.post(url, headers=headers, json=data)
        
        # æ£€æŸ¥ HTTP çŠ¶æ€ç ï¼Œå¦‚æœè¯·æ±‚å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸
        response.raise_for_status()
        
        print("âœ… è¯·æ±‚æˆåŠŸå®Œæˆï¼")
        print("-" * 30)
        
        # æ‰“å°å“åº”çŠ¶æ€ç 
        print(f"ğŸ“Š çŠ¶æ€ç : {response.status_code}")
        
        # è§£æå¹¶æ ¼å¼åŒ– JSON å“åº”
        print("ğŸ“„ å“åº”å†…å®¹:")
        formatted_json = json.dumps(response.json(), indent=2, ensure_ascii=False)
        print(formatted_json)
        
        print("=" * 50)
        print("ğŸ‰ æµ‹è¯•æ‰§è¡Œå®Œæ¯•ï¼")
        
    except requests.exceptions.RequestException as e:
        # å¤„ç†ç½‘ç»œè¯·æ±‚ç›¸å…³çš„é”™è¯¯
        print(f"âŒ è¯·æ±‚é”™è¯¯: {e}")
        print("ğŸ’¡ å»ºè®®æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ– API å¯†é’¥é…ç½®")
        
    except ValueError as e:
        # å¤„ç† JSON è§£æé”™è¯¯
        print(f"âŒ JSON è§£æé”™è¯¯: {e}")
        print("ğŸ’¡ å»ºè®®æ£€æŸ¥ API å“åº”æ ¼å¼æ˜¯å¦æ­£ç¡®")
        
    except Exception as e:
        # å¤„ç†å…¶ä»–æœªé¢„æœŸçš„é”™è¯¯
        print(f"âŒ æœªé¢„æœŸçš„é”™è¯¯: {e}")
        print("ğŸ’¡ è¯·è”ç³»æŠ€æœ¯æ”¯æŒ")

# =============================================================================
# ç¨‹åºå…¥å£ç‚¹
# =============================================================================

if __name__ == "__main__":
    main()
```

## ğŸ“Š è¿”å›ç¤ºä¾‹

æˆåŠŸè°ƒç”¨åçš„å“åº”ç¤ºä¾‹ï¼š

```json
ğŸš€ å¼€å§‹æ‰§è¡Œ DMX API æµ‹è¯•...
==================================================
ğŸ“¡ æ­£åœ¨å‘é€è¯·æ±‚åˆ° DMX API...
âœ… è¯·æ±‚æˆåŠŸå®Œæˆï¼
------------------------------
ğŸ“Š çŠ¶æ€ç : 200
ğŸ“„ å“åº”å†…å®¹:
{
  "id": "msg_014wEHmwF1pLPwPp3RsJwg1p",
  "type": "message",
  "role": "assistant",
  "model": "claude-sonnet-4-5-20250929",
  "content": [
    {
      "id": "toolu_01CE8aJWhYoiVwMPw7KRujQz",
      "type": "tool_use",
      "name": "get_weather",
      "input": {
        "location": "åŒ—äº¬"
      }
    }
  ],
  "stop_reason": "tool_use",
  "usage": {
    "input_tokens": 668,
    "cache_creation_input_tokens": 0,
    "cache_read_input_tokens": 0,
    "output_tokens": 54,
    "cache_creation": {},
    "claude_cache_creation_5_m_tokens": 0,
    "claude_cache_creation_1_h_tokens": 0
  }
}
==================================================
ğŸ‰ æµ‹è¯•æ‰§è¡Œå®Œæ¯•ï¼
```

## ğŸ“ ä½¿ç”¨è¯´æ˜

1. **API å¯†é’¥é…ç½®**ï¼šå»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡ `DMXAPI_API_KEY` è®¾ç½®å¯†é’¥
2. **è¯·æ±‚æ ¼å¼**ï¼šä½¿ç”¨ JSON æ ¼å¼ï¼ŒåŒ…å«æ¨¡å‹ã€æ¶ˆæ¯å’Œå·¥å…·å®šä¹‰
3. **é”™è¯¯å¤„ç†**ï¼šä»£ç åŒ…å«å®Œæ•´çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
4. **å·¥å…·è°ƒç”¨**ï¼šæ”¯æŒè‡ªå®šä¹‰å·¥å…·å®šä¹‰å’Œå‚æ•°éªŒè¯

## ğŸ”§ æ³¨æ„äº‹é¡¹

- ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸
- éªŒè¯ API å¯†é’¥çš„æœ‰æ•ˆæ€§
- æ£€æŸ¥è¯·æ±‚å‚æ•°çš„å®Œæ•´æ€§
- å¤„ç†å¯èƒ½çš„ç½‘ç»œè¶…æ—¶æƒ…å†µ

---

<p align="center">
  <small>Â© 2025 DMXAPI Claudeå‡½æ•°è°ƒç”¨</small>
</p>